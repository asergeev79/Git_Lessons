# Работа с Git
## 1. Проверка наличия установленного Git.
В терминале выполнить команду `git version`.

Если Git установлен, появится сообщение с информацией о версии программы. Иначе будет сообщение об ошибке.

## 2. Установка Git.
Загружаем последнюю версию Git с сайта https://git-scm.com/downloads
Устанавливаем с настройками по умолчанию.

## 3. Настройка Git
При первом использовании Git необходимо представиться. Для этого в терминале необходимо выполнить команды:
```
git config --global user.email "your@email"
git config --global user.name "Your Name"
```

## 4. Инициализация репозитория.
Для создания репозитория необходимо выполнить в терминале команду:
```
git init
```
Команду `git init` выполняют только один раз для первоначальной настройки нового репозитория. Выполнение команды приведет к созданию нового подкаталога `.git` в текущем рабочем каталоге. Кроме того, будет создана новая главная ветка.

Для инициализации репозитория в определённой папке необходимо создать эту папку, перейти в неё и выполнить команду инициализации:
```
cd /path/to/your/existing/code 
git init
```
Также можно указать папку проекта в команде инициализации:
```
git init <project_folder>
```
В этом случае инициализация репозитория произойдёт в указанной папке.

## 5. Запись изменений в репозиторий
### 5.1. Команда git status
Команда `git status` отображает состояние рабочего каталога и раздела проиндексированных файлов. С ее помощью можно проверить индексацию изменений и увидеть файлы, которые не отслеживаются Git.

### 5.2. Команда git add
Команда `git add` добавляет изменение из рабочего каталога в раздел проиндексированных файлов. Она сообщает Git, что мы хотим включить изменения в конкретном файле в следующий коммит.
* В рабочем каталоге создадим файл `NewFile.txt` с каким-либо текстом.
* Команда `git status` покажет, что новый файл не отслеживается Git
```
$ git status
On branch master
...
Untracked files:
  (use "git add <file>..." to include in what will be committed)
        NewFile.txt

no changes added to commit (use "git add" and/or "git commit -a")
```
* Добавим новый файл в репозиторий проиндексированных файлов
```
git add NewFile.txt
```
* Проверим, что файл доббавлен
```
$ git status
On branch master
Changes to be committed:
  (use "git restore --staged <file>..." to unstage)
        new file:   NewFile.txt
```
Команду `git add` часто используют с флагом --all. Команда `git add --all` добавляет все измененные и неотслеживаемые файлы в репозиторий и обновляет дерево изменений репозитория.

### 5.3. Команда git commit
Команда `git commit` делает для проекта снимок текущего состояния изменений, добавленных в раздел проиндексированных файлов.

Перед выполнением команды `git commit` необходимо использовать команду `git add`, чтобы добавить в проект («проиндексировать») изменения, которые будут сохранены в коммите.

Сохраним изменения из предыдущего пункта:
```
git commit
```
Эта команда откроет текстовый редактор для ввода комментария к коммиту и покажет список файлов, которые будут зафиксированы в этом коммите:
```
# Please enter the commit message for your changes. Lines starting
# with '#' will be ignored, and an empty message aborts the commit.
#
# On branch master
# Changes to be committed:
#       new file:   NewFile.txt
#
```
Далее необходимо ввести информативный комментарий (i - вставка текста, ESC - выход из режима редактирования) и сохранить его (:wq).

После сохранения комментария Git выведет информацию о принятых изменениях:
```diff
$ git commit
[master 480a789] Добавление файла NewFile.txt
 1 file changed, 1 insertion(+)
 create mode 100644 NewFile.txt
```
Для проведения коммита без вызова текстового редактора можно использовать команду:
```
git commit -m "commit message"
```
Чтобы выполнить коммит состояния со всеми изменениями в рабочем каталоге (без предварительной команды `git add`), можно использовать команду
```
git commit -a
```
Эта команда включает только изменения отслеживаемых файлов, которые уже были в какой-то момент добавлены в историю с помощью команды `git add`.

Комбинация параметров создает коммит всех проиндексированных изменений и добавляет к коммиту подставленный комментарий:
```
git commit -am "commit message"
```

### 5.4. Команда git diff
Чтобы посмотреть все неподтвержденные изменения, внесенные после последнего коммита, необходимо в терминале ввести команду:
```
git diff
```
В результате будет выведена служебная информация, позволяющая проанализировать изменения перед коммитом:
```diff
$ git diff
diff --git a/Git_Instruction.md b/Git_Instruction.md
index f1407f6..708e01b 100644
--- a/Git_Instruction.md
+++ b/Git_Instruction.md
@@ -33,4 +33,79 @@ git init <project_folder>

 В этом случае инициализация репозитория произойдёт в указанной папке.

+## 5. Запись изменений в репозиторий
+### 5.1. Команда git status
+Команда `git status` отображает состояние рабочего каталога и раздела проиндексированных файлов. С ее помощью можно проверить индексацию изменений и увидеть файлы, 
которые не отслеживаются Git.
```

## 6. Просмотр истории коммитов.
Чтобы посмотреть список всех коммитов, в терминале надо ввести команду:
```
git log
```
Вывод команды может быть слишком громоздким:
```
$ git log
commit f8e5e59cc7affeaf24418af939431228cfd4c1be (HEAD -> master)
Author: asergeev <asergeev.me@yandex.ru>
Date:   Thu Dec 8 09:15:39 2022 +0300

    Добавление раздела 5

commit 05433b54f89142b8b89eece85c31a5d88d82391f
Author: asergeev <asergeev.me@yandex.ru>
Date:   Thu Dec 8 09:05:42 2022 +0300

    Удаление файла NewFile.txt
```
Для сокращения вывода необходимо добавить параметр `--oneline`:
```
git log --oneline
```
Тогда будет выведен однострочный список коммитов, содержащий идентификатор коммита и первую строка комментария к нему:
```
$ git log --oneline
f8e5e59 (HEAD -> master) Добавление раздела 5
05433b5 Удаление файла NewFile.txt
480a789 Добавление файла NewFile.txt
359c6d2 Добавление раздела 4
fd90565 Добавили подзаголовок 4
2b9c8d4 Добавили раздел 3
97d5335 Добавили раздел 2
6a16ece Добавили раздел 1
```
Команду `git log` часто используют вместе с другими командами. Обычно найденный коммит передают другому инструменту (например, `git checkout`), позволяющему воздействовать на историю коммитов.

## 7. Перемещение между сохранениями
После того как нашли ссылку на нужный коммит в истории:
```
$ git log --oneline
c5fc93c (HEAD -> master) Добавление раздела 6
f8e5e59 Добавление раздела 5
05433b5 Удаление файла NewFile.txt
480a789 Добавление файла NewFile.txt
359c6d2 Добавление раздела 4
fd90565 Добавили подзаголовок 4
2b9c8d4 Добавили раздел 3
97d5335 Добавили раздел 2
6a16ece Добавили раздел 1
```
для перехода к нему можно использовать команду `git checkout`:
```
git checkout 359c6d2
```
Может случиться ситуация, что будет выведено сообщение об ошибке:
```
error: Your local changes to the following files would be overwritten by checkout:
        Git_Instruction.md
Please commit your changes or stash them before you switch branches.
Aborting
```
Это значит, что есть не утверждённые изменения, и необходимо сделать коммит, либо спрятать изменения (stash).

При стандартном процессе разработки указатель HEAD обычно указывает на главную ветку master или другую локальную ветку. Но при переключении на предыдущий коммит HEAD указывает уже не на ветку, а непосредственно на сам коммит:
```
$ git checkout 359c6d2
Note: switching to '359c6d2'.

You are in 'detached HEAD' state. You can look around, make experimental
...

$ git log --oneline
359c6d2 (HEAD) Добавление раздела 4
fd90565 Добавили подзаголовок 4
2b9c8d4 Добавили раздел 3
97d5335 Добавили раздел 2
6a16ece Добавили раздел 1
```
Это приведет к тому, что рабочий каталог будет в точности соответствовать состоянию коммита 359c6d2. Можно просматривать файлы, компилировать проект, запускать тесты и даже редактировать файлы, не боясь потерять текущее состояние проекта. Никакие внесенные здесь изменения не будут сохранены в репозитории. Чтобы продолжить разработку, необходимо вернуться к текущему состоянию проекта:
```
$ git checkout master
Previous HEAD position was 359c6d2 Добавление раздела 4
Switched to branch 'master'
```

## 8. Игнорирование файлов
Не все файлы в проекте должны отслеживаться Git. Временные файлы из среды разработки, выходные данные тестов и журналы — это все примеры файлов, которые, вероятно, не нужно отслеживать. Для файлов, которые не отслеживаются Git, можно использовать `.gitignore` файл. Для файлов, отслеживаемых Git, можно сообщить Git прекратить их отслеживание и игнорировать изменения.

![logo](logo@2x.png)

Для примера добавим изображение в инструкцию. Для этого в папку проекта добавим файл изображения (в данном случае logo@2x.png), а в самой инструкции в месте, где необходимо вставить изображение, вставим:
```
![logo](logo@2x.png)
```
Однако, такого типа файлы обычно не отслеживаются в Git. Тогда их необходимо игнорировать. Для этого добавим его в `.gitignore`.

В связи с тем, что таких файлов может быть много, удобней использовать шаблоны. Например, `*.png`.

Сам файл `.gitignore` является отслеживаемым в проекте Git. Следовательно его необходимо добавить:
```
git add .gitignore
```
и затем закоммитить изменения:
```
git commit -m "Добавление .gitignore"
```

## 9. Работа с ветками
Ветка представляет собой отдельное направление разработки. Ветки выступают в качестве абстрактного представления для процесса редактирования/индексации/коммита. Можно рассматривать их как способ запросить новый рабочий каталог, раздел проиндексированных файлов и историю проекта. Новые коммиты записываются в историю текущей ветки, что приводит к образованию развилки в истории проекта.
### 9.1. Создание веток
Чтобы создать новую ветку, необходимо в терминале выполнить команду:
```
git branch <new-branch>
```
Затем для работы в новой ветке необходимо перейти в неё, используя команду:
```
git checkout <new-branch>
```
Эти команды можно объединить. Так, для того, чтобы создать новую ветку и сразу перейти в неё, необходимо в терминале выполнить команду:
```
git checkout -b <new-branch>
```
### 9.2. Удаление веток
Для удаления ветки надо выполнить команду в терминале:
```
git branch -d <branch>
```
В этом случае возможна ошибка, если не было проведено слияние веток:
```
$ git branch -d delete-branch
error: The branch 'delete-branch' is not fully merged.
If you are sure you want to delete it, run 'git branch -D delete-branch'.
```
Если необходимо удалить ветку в любом случае, тогда параметр будет таким:
```
git branch -D <branch>
```
### 9.3. Переключение между ветками
Команда `git checkout` позволяет перемещаться между ветками, созданными командой `git branch`. При переключении ветки происходит обновление файлов в рабочем каталоге в соответствии с версией, хранящейся в этой ветке, а Git начинает записывать все новые коммиты в этой ветке.

Для вывода списка всех веток в терминале надо выполнить команду:
```
git branch
```
Затем для перехода в необходимую ветку выполняем команду:
```
git checkout <branch>
```

### 9.4. Слияние веток
Слияние используется в Git, чтобы собрать воедино разветвленную историю. Команда `git merge` выполняет слияние отдельных направлений разработки, созданных с помощью команды `git branch`, в единую ветку.

При этом команды выполняют слияние в текущую ветку, в то время как целевая ветка остается без изменений. Поэтому команда `git merge` часто используется в сочетании с командами `git checkout` (для выбора текущей ветки) и `git branch -d` (для удаления устаревшей целевой ветки).

Таким образом, сначала в рабочей ветке выполняем коммит:
```
git commit -am "Комментарий"
```
затем переходим в ветку, куда будем объединяться:
```
git checkout <целевая ветка>
```
и объединяем ветку, которую хотим:
```
git merge <branch>
